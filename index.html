<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" type="image/jpg" href="images/favicon.jpg" />
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>

    <!-- jQueryUI library -->
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <!-- Latest compiled Bootstrap JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

    <!-- D3 library -->
    <script type="text/javascript" src="javascripts/external/d3v3.min.js"></script>

    <!-- Bootstrap-slider -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.8.1/bootstrap-slider.js"></script>

    <!-- Bootstrap Datepicker -->
    <script src="javascripts/external/bootstrap-datepicker.min.js"></script>

    <!-- Bootstrap Datepicker pt-br locale -->
    <script src="javascripts/external/bootstrap-datepicker.pt-BR.js"></script>

    <!-- Spin.js - Loading Spinner Effect -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/spin.js/2.3.2/spin.min.js"></script>

    <!-- Plugin for creation of custom context menus -->
    <script src = "javascripts/external/jquery.contextMenu.js" type = "text/javascript"></script>

    <!-- Library for crossfilter charts -->
    <script src = "javascripts/external/crossfilter.v1.min.js" type = "text/javascript"></script>

    <!-- Library for queue structure -->
    <script src="javascripts/external/queue.v1.min.js" type="text/javascript"></script>

    <!-- Library for complex numeric operations -->
    <script src="javascripts/external/numeric-1.2.6.js" type="text/javascript"></script>

    <!-- Library for translation -->
    <script src="javascripts/external/translate.js" type ="text/javascript"></script>

    <!-- Structure tree -->
    <script src="javascripts/external/tree.js"></script>

    <!-- Scatter Plot visualization -->
    <script src="javascripts/scatter-plot.js"></script>

    <!-- Bar Chart visualization -->
    <script src="javascripts/bar-chart.js"></script>

    <!-- Force Layout visualization -->
    <script src="javascripts/force-layout.js"></script>

    <!-- Timeline visualization -->
    <script src="javascripts/time-line.js"></script>

    <!-- Timeline crop visualizations -->
    <script src="javascripts/time-line-crop.js"></script>

    <!-- Chamber infographic visualization -->
    <script src="javascripts/chamber-infographic.js"></script>

    <!-- Roll Calls HeatMap visualization -->
    <script src="javascripts/rollcalls-heatmap.js"></script>

    <!-- Deputies Similarity Force Layout visualization -->
    <script src="javascripts/similarity-force-chart.js"></script>

    <!-- Windows System View Functions -->
    <script src="javascripts/windows-system.js"></script>

    <!-- Windows System Controller Functions -->
    <script src="javascripts/windows-system-controller.js"></script>

    <!-- K-Means clusterization library -->
    <script src="javascripts/external/kmeans.js"></script>

    <!-- Convex Hull library -->
    <script src="javascripts/external/convex-hull.js"></script>

    <!-- D3 v4 -->
    <script src="javascripts/external/d3v4.min.js"></script>

    <!-- Congress Definitions -->
    <script src="javascripts/congress-definitions.js"></script>

    <!-- Dimensionality Reduction Functions -->
    <script src="javascripts/dimensionality-reduction.js"></script>

    <!-- Scale Adjustment Functions -->
    <script src="javascripts/scaleAdjustment.js"></script>

    <!-- TSNe Functions -->
    <script src="javascripts/external/tsne.js"></script>

    <!-- D3-tip library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.6.3/d3-tip.min.js"></script>

    <!-- Intro JS -->
    <script src= "javascripts/external/intro.js"></script>

    <!-- All the customized intro functions -->
    <script src= "javascripts/introFunctions.js"></script>

    <!-- Bootstrap-slider CSS -->
    <link rel ="stylesheet" href= "https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.8.1/css/bootstrap-slider.css">

    <!-- Windows System CSS -->
    <link rel="stylesheet" href="stylesheets/windows-system.css">

    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="stylesheets/font-awesome.css">

    <!-- Scatter Plot CSS -->
    <link rel="stylesheet" href="stylesheets/scatter-plot.css">

    <!-- Force Layout CSS -->
    <link rel="stylesheet" href="stylesheets/force-layout.css">

    <!-- Bar Chart CSS -->
    <link rel="stylesheet" href="stylesheets/bar-chart.css">

    <!-- Time Line Chart CSS -->
    <link rel="stylesheet" href="stylesheets/time-line.css">

    <!-- Heat Map Chart CSS -->
    <link rel="stylesheet" href="stylesheets/rollcalls-heatmap.css">

    <!-- Intro.js CSS -->
    <link rel="stylesheet" href="stylesheets/introjs.css">

    <!-- Datepicker CSS -->
    <link rel="stylesheet" href="stylesheets/bootstrap-datepicker3.css">

    <!-- Flags CSS -->
    <link rel="stylesheet" href="stylesheets/flag-icon.css">

    <!-- Spinner gif library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/spin.js/2.3.2/spin.min.js"></script>

    <!-- Latest compiled and minified CSS for Bootstrap Select-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/css/bootstrap-select.min.css">

    <!-- Latest compiled and minified JavaScript for Bootstrap Select  -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/js/bootstrap-select.min.js"></script>

    <!-- Bootstrap Tree view  -->
    <script src="javascripts/external/bootstrap-treeview-1.2.0/src/js/bootstrap-treeview.js"></script>

    <script src="javascripts/external/bootstrap-tagsinput.js"></script>
    <link rel ="stylesheet" href="stylesheets/bootstrap-tagsinput.css">
    <link rel ="stylesheet" href="stylesheets/typehead.css">

    <script src="javascripts/external/typeahead.bundle.js"></script>

    <title> CivisAnalysis 2.0  </title>
</head>

<body id = "windows-system">
<div id="loading">
    <div id="greyScreen"></div>
    <img src="./images/ajax_loader.gif" width="100px" class="gif">
    <span id="msg" class="gif">Loading</span>
</div>

<div id="mySidebar" class="sidebar">
    <h2>Treeview</h2>
    <div id="tree"></div>
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">×</a>
</div>

<!-- Modal -->
<div class="modal fade" id="languageModal" role="dialog">
        <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <h4 class="modal-title">Please, choose your language:</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="column">
                        <img id = "pt-br" class="flag" src="images/flags/4x3/br.svg" alt="Brazil Flag" style="width:100%">
                    </div>
                    <div class="column">
                        <img id = "en-us" class="flag" src="images/flags/4x3/us.svg" alt="US Flag" style="width:100%">
                    </div>
                </div>
                <div class="row">
                    <div class="column text-center">
                        <strong>Portuguese - BR</strong>
                    </div>
                    <div class="column text-center">
                        <strong>English - US</strong>
                    </div>
                </div>
            </div>
          </div>
        </div>
      </div>

<div id = "navbar">
    <button class="openbtn" onclick="openNav()">☰</button><h2>CivisAnalysis 2.0</h2>
    <label id="selectLabel" for="selStates"></label>
    <select class="selectpicker" title= "Choose one of the following...>" multiple id="selStates">
        <option value="AC">Acre</option>
        <option value="AL">Alagoas</option>
        <option value="AP">Amapá</option>
        <option value="AM">Amazonas</option>
        <option value="BA">Bahia</option>
        <option value="CE">Ceará</option>
        <option value="DF">Distrito Federal</option>
        <option value="ES">Espírito Santo</option>
        <option value="GO">Goiás</option>
        <option value="MA">Maranhão</option>
        <option value="MT">Mato Grosso</option>
        <option value="MS">Mato Grosso do Sul</option>
        <option value="MG">Minas Gerais</option>
        <option value="PA">Pará</option>
        <option value="PB">Paraíba</option>
        <option value="PR">Paraná</option>
        <option value="PE">Pernambuco</option>
        <option value="PI">Piauí</option>
        <option value="RJ">Rio de Janeiro</option>
        <option value="RN">Rio Grande do Norte</option>
        <option value="RS">Rio Grande do Sul</option>
        <option value="RO">Rondônia</option>
        <option value="RR">Roraima</option>
        <option value="SC">Santa Catarina</option>
        <option value="SP">São Paulo</option>
        <option value="SE">Sergipe</option>
        <option value="TO">Tocantins</option>
    </select>
    <button id = "statesBtn" type="button" class="btn btn-default trn">Apply filter</button>
    <button id = "resetBtn" type="button" class="btn btn-default trn">Reset all selections</button>
    <label style = "display:none"> <input id="match" type="checkbox"> Match Deputies </label>
    <!--
       <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#languageModal" data-backdrop="static" data-keyboard="false">Open Modal</button> 
    -->
</div>


<div class="container">
    <svg id ="workspace" width = "100%" height = "100%" class="svg-content-responsive"></svg>
    <!-- Secondary, outline button -->
    <ul id="contextMenuScatterPlot" class="dropdown-menu" role="menu" style="display:none" >
        <li><a tabindex="-1" id="bar-chart">Create a bar chart</a></li>
        <li><a tabindex="-1" id="force-layout">Show parties clusters</a></li>
    </ul>
    <ul id="contextMenuTimeline" class="dropdown-menu" role="menu" style="display:none" >
        <li><a tabindex="-1" id="scatter-plot-pca">Create a Political Spectrum of Deputies - Technique: PCA</a></li>
        <li><a tabindex="-1" id="scatter-plot-mds">Create a Political Spectrum of Deputies - Technique: MDS</a></li>
        <li><a tabindex="-1" id="scatter-plot-tsne">Create a Political Spectrum of Deputies - Technique: t-SNE</a></li>
        <li><a tabindex="-1" id="chamber-infographic">Create a Chamber Infographic</a></li>
        <li><a tabindex="-1" id="deputies-similarity-force">Create a Deputies Similarity Graph</a></li>
        <li><a tabindex="-1" id="rollcalls-heatmap">Create a Map of Roll Calls</a></li>
    </ul>
    <ul id="contextMenuDeputy" class="dropdown-menu" role="menu" style="display:none" >
        <li><a tabindex="-1" id="rollcalls-heatmap">Create a Map of Roll Calls</a></li>
        <li><a class="btn disabled" style="text-align:left;" tabindex="-1" id="time-line-crop-behavior-selection">Create a timeline with selected deputies</a></li>
    </ul>
</div>

<div class ="toolTip" style="display: none;"></div>
<div class ="toolTipHeatMap" style="display: none;"></div>
<div class ="toolTip toolTipCluster" style="display: none;"></div>

</body>
</html>

<script>

    /* Getting the document body */
    var windowSystem = $("#windows-system");

    function openNav() {
        document.getElementById("mySidebar").style.width = "250px";
        document.getElementById("windows-system").style.marginLeft = "250px";
        checkLimits(true);
    }

    function closeNav() {
        document.getElementById("mySidebar").style.width = "0";
        document.getElementById("windows-system").style.marginLeft= "0";
        checkLimits(false);
    }

    /* Initialization of System */
    $(document).ready(function(){
        $("#navbar").hide();

        /* Open language modal */
        $('#languageModal').modal({backdrop: 'static', keyboard: false}); 
        resizeTimeline();

        /* Check limits whenever a resize event was trigger */
        $(window).on('resize', function(){
            hideToolTipCluster();
            checkLimits(isSideBarActive());
        });

        /* Binding event to minimize buttons */
        windowSystem.on("click", ".btn-minimize", minimizeWindow);

        /* Binding event to remove buttons */
        windowSystem.on("click", ".btn-remove", function(){
            var id = $(this).parents(".panel").attr("id");
            removeWindow(id, true);
        });

        /* Binding event to scatter plot settings buttons */
        //windowSystem.on("click", ".btn-settings-scatterplot", checkChildrenScatterPlot);

        /* Binding event to minimized window */
        windowSystem.on("dblclick", ".minimized-icon", function(event){
            var panelID = ($(this)).attr("id").replace("icon-", "");
            maximizeWindow(panelID);
        });

        /* Binding event to any click in a panel active respective node in tree view */
        windowSystem.on('click', '.panel', function(event){
            console.log($(event.target));
            var isMinimizeButton = $(event.target).hasClass('btn-minimize') || $(event.target).hasClass('glyphicon-minus');
            console.log(isMinimizeButton);
            if(isMinimizeButton)
                return;
            console.log("clicou no painel")
            var id = $(this)[0].id;
            selectNodeSideBarByPanel(id);
        });

        /* Avoid to close settings menu */
        windowSystem.on('click', '.panel-settings', function(event){
            event.stopPropagation();
        });

        windowSystem.on('mousedown', '.panel .node', function(event){
            checkPeriodTimeLineCrop(event, this);
        });

        windowSystem.on('click', '#resetBtn', function() {
            /* Reset the States select box values */
            $('#selStates').selectpicker('val', '');
            resetSelection();
        });

        windowSystem.on('click', '#statesBtn', selectByStates);

        windowSystem.on('click', '#pt-br', function() {
            language = PORTUGUESE;
            $('#languageModal').modal('hide');
            $("#navbar").show();
            initSystem();
            /* Initialize all translations of system */
            initDict();
        });

        windowSystem.on('click', '#en-us', function() {
            language = ENGLISH;
            $('#languageModal').modal('hide');
            $("#navbar").show();
            initSystem();
            /* Initialize all translations of system */
            initDict();
        });

        var activeBrush = true;
        d3.select(window)
            .on("keydown", function (event) {
                if (!activeBrush) {
                    return;
                }
                enableBrushForAllScatterPlots();
                activeBrush = false;
            })
            .on("keyup", function(){
                activeBrush = true;
                disableBrushForAllScatterPlots();
            });

    });

</script>